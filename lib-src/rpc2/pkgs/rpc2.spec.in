Name: @PACKAGE@
Version: @VERSION@
Release: 1
Summary: RPC2 library

Group: System Environment/Libraries
License: LGPLv2
URL: http://www.coda.cs.cmu.edu/
Source0: ftp://ftp.coda.cs.cmu.edu/pub/coda/src/%{name}-%{version}.tar.gz

BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
BuildRequires: libtool lwp-devel flex bison pkgconfig %{?_with_lua:, lua-devel}

%description
The RPC2 library.


%package devel
Summary: Development files for %{name}
Group: Development/Libraries

%description devel
The %{name}-devel package contains libraries and header files and tools for
developing applications that use %{name}.


%prep
%setup -q

%build
%configure --disable-static %{?_with_lua}
make %{?_smp_mflags}

%install
rm -rf $RPM_BUILD_ROOT
make install DESTDIR=$RPM_BUILD_ROOT
find $RPM_BUILD_ROOT -name '*.la' -exec rm -f {} ';'

%clean
rm -rf $RPM_BUILD_ROOT


%post -p /sbin/ldconfig

%postun -p /sbin/ldconfig


%files
%defattr(-,root,root,-)
%doc COPYING NEWS README.ipv6
%{_libdir}/*.so.*
%{?_with_lua: %{_datadir}/%{name}}


%files devel
%defattr(-,root,root,-)
%{_bindir}/rp2gen
%{_includedir}/rpc2
%{_libdir}/*.so
%{_libdir}/pkgconfig/*

