dnl Process this file with autoconf to produce a configure script

dnl Initialization
AC_PREREQ(2.50)
AC_INIT(rvm, 1.14)
AC_CONFIG_SRCDIR(rvm/rvm_private.h)
AM_INIT_AUTOMAKE
AC_CONFIG_HEADERS(config.h)

dnl For library version updates, follow these steps in order.
dnl - when any library source has changed, increment first
dnl - when interfaces were added/removed changed, increment second and set
dnl   first to 0
dnl - if any interfaces were added, increment third
dnl - if any interfaces were removed, set third to 0
CODA_LIBRARY_VERSION(2, 3, 2)

CONFIG_DATE=`date +"%a, %d %b %Y %T %z"`
AC_SUBST(CONFIG_DATE, "$CONFIG_DATE", [Date when configure was last run])

dnl Checks for programs.
AC_PROG_CC
AC_PROG_CPP
AC_PROG_INSTALL
AC_PROG_MAKE_SET
AM_PROG_LIBTOOL

dnl pkg-config stuff
PKG_PROG_PKG_CONFIG([0.18.0])
PKG_CHECK_MODULES([LWP], [lwp])

dnl Checks for libraries.
AC_SEARCH_LIBS(fdatasync, rt)

dnl Checks for header files.
dnl Checks for typedefs.

dnl Checks for compiler characteristics.
CODA_CC_FEATURE_TEST(Wall)

dnl Checks for library functions.
AC_CHECK_FUNCS(strerror fdatasync)
AC_FUNC_MMAP

dnl Checks for system services.

dnl Generate output files
AC_CONFIG_FILES(Makefile include/Makefile include/rvm/Makefile rvm/Makefile seg/Makefile rds/Makefile tests/Makefile pkgs/Makefile pkgs/pkg-bsd.sh pkgs/rvm.pc pkgs/rvmlwp.pc pkgs/rvm.spec debian/Makefile debian/changelog)
AC_OUTPUT

