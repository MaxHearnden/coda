Name: @PACKAGE@
Version: @VERSION@
Release: 1
Summary: RVM persistent recoverable memory library

Group: System Environment/Libraries
License: LGPLv2
URL: http://www.coda.cs.cmu.edu/
Source: ftp://ftp.coda.cs.cmu.edu/pub/coda/src/%{name}-%{version}.tar.gz

BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
BuildRequires: libtool lwp-devel pkgconfig

%description
The RVM persistent recoverable memory library. The RVM library is used by
the Coda distributed filesystem.


%package tools
License: GPLv2
Summary: RVM tools
Group: System Environment/Libraries

%description tools
Userspace tools to initialize and manipulate RVM log and data segments.
The RVM library is used by the Coda distributed filesystem.


%package devel
Summary: Development files for %{name}
Group: Development/Libraries
Requires: %{name} = %{version}-%{release}

%description devel
The %{name}-devel package contains libraries and header files for
developing applications that use %{name}.


%prep
%setup -q

%build
%configure --disable-static
make %{_smp_mflags}

%install
rm -rf $RPM_BUILD_ROOT
make install DESTDIR=$RPM_BUILD_ROOT
find $RPM_BUILD_ROOT -name '*.la' -exec rm -f {} ';'

%clean
rm -rf $RPM_BUILD_ROOT


%post -p /sbin/ldconfig

%postun -p /sbin/ldconfig


%files
%defattr(-,root,root,-)
%doc COPYING NEWS
%{_libdir}/*.so.*


%files tools
%defattr(-,root,root,-)
%{_sbindir}/rvmutl
%{_sbindir}/rdsinit


%files devel
%defattr(-,root,root,-)
%{_includedir}/rvm
%{_libdir}/*.so
%{_libdir}/pkgconfig/*

