Summary: RVM library
Name: @PACKAGE@
Version: @VERSION@
Release: 1
Source: ftp://ftp.coda.cs.cmu.edu/pub/coda/src/%{name}-%{version}.tar.gz
License: LGPL
BuildRoot: %{_builddir}/%{name}-%{version}/Root
Group: Development/Libraries
%description
The RVM persistent recoverable memory library. The RVM library is used by
the Coda distributed filesystem.

%package tools
Summary: RVM tools
Group: Development/Libraries
%description tools
Userspace tools to initialize and manipulate RVM log and data segments.
The RVM library is used by the Coda distributed filesystem.

%package devel
Summary: RVM library development files
Group: Development/Libraries
%description devel
Headers and static libraries for developing programs using the RVM library.
The RVM library is used by the Coda distributed filesystem.

%changelog
* Tue Oct 26 1999 Jan Harkes <jaharkes@cs.cmu.edu>
- First stab at packaging the rvm library.

%prep
%setup -n %{name}-%{version}

%build
./configure --prefix=/usr
make

%install
rm -rf $RPM_BUILD_ROOT
mkdir -p $RPM_BUILD_ROOT
make prefix=$RPM_BUILD_ROOT/usr install
chmod 755 $RPM_BUILD_ROOT/usr/lib/librvm.so.@LINUX_VERSION@
chmod 755 $RPM_BUILD_ROOT/usr/lib/librvmlwp.so.@LINUX_VERSION@
chmod 755 $RPM_BUILD_ROOT/usr/lib/libseg.so.@LINUX_VERSION@
chmod 755 $RPM_BUILD_ROOT/usr/lib/librds.so.@LINUX_VERSION@
chmod 755 $RPM_BUILD_ROOT/usr/lib/librdslwp.so.@LINUX_VERSION@
rm -f $RPM_BUILD_ROOT/usr/lib/librvm.so.@MAJOR_VERSION@
rm -f $RPM_BUILD_ROOT/usr/lib/librvmlwp.so.@MAJOR_VERSION@
rm -f $RPM_BUILD_ROOT/usr/lib/libseg.so.@MAJOR_VERSION@
rm -f $RPM_BUILD_ROOT/usr/lib/librds.so.@MAJOR_VERSION@
rm -f $RPM_BUILD_ROOT/usr/lib/librdslwp.so.@MAJOR_VERSION@

%clean
rm -rf $RPM_BUILD_ROOT

%post
/sbin/ldconfig

%files
%defattr(-,root,root)
/usr/lib/librvm.so.@LINUX_VERSION@
/usr/lib/librvmlwp.so.@LINUX_VERSION@
/usr/lib/libseg.so.@LINUX_VERSION@
/usr/lib/librds.so.@LINUX_VERSION@
/usr/lib/librdslwp.so.@LINUX_VERSION@

%files tools
%defattr(-,root,root)
/usr/sbin/rvmutl
/usr/sbin/rdsinit

%files devel
%defattr(-,root,root)
/usr/lib/librvm.la
/usr/lib/librvm.a
/usr/lib/librvm.so
/usr/lib/librvmlwp.la
/usr/lib/librvmlwp.a
/usr/lib/librvmlwp.so
/usr/lib/libseg.la
/usr/lib/libseg.a
/usr/lib/libseg.so
/usr/lib/librds.la
/usr/lib/librds.a
/usr/lib/librds.so
/usr/lib/librdslwp.la
/usr/lib/librdslwp.a
/usr/lib/librdslwp.so
%dir /usr/include/rvm
/usr/include/rvm/rvm.h
/usr/include/rvm/rvm_statistics.h
/usr/include/rvm/rvm_segment.h
/usr/include/rvm/rds.h

